author: chtld(张尚元)

date: 2018-04-30



### 常微分方程数值解

从一个最简单的例子开始，即一阶常微分方程初值问题

$$y'=f(x,y),x\in[x_0,b]$$

$$y(x_0)=y_0$$

关于常微分方程的初值问题的解得存在唯一性以后再讨论。

在这里我们谈论的是数值解，数值解首先的一步就是对区域进行离散，将区间$[x_0,b]$离散为$x_0,x_1,x_2,...,x_n=b$, 并记$h_i=x_{i+1}-x_i$, 若采用均匀剖分，即$h_i=h, x_i=x_0+nh$,看到这个方程最一般的思路就是

1. 用差商代替导数，则有两种思路

   向前，即$f(x_i,y_i)=y'(x_i)\approx\frac{y_{i+1}-y_i}{x_{i+1}-x{i}}$，由此形成的叫欧拉(Euler)法，显格式

​       向后，即$f(x_i,y_i)=y'(x_i)\approx\frac{y_{i}-y_{i-1}}{x_{i}-x{i-1}}$，由此形成的叫后退欧拉法，隐格式

2. 对方程两边积分，用数值积分公式中的左右矩形公式则也可得上面的两种格式

​       $$\int_{x_0}^xy'dx=\int_{x_0}^xf(x,y)dx$$

​        $y(x)=y(x_0)+\int_{x_0}^xf(x,y)dx$

​        左矩形(显式)：$y_{i+1}=y_{i}+h_i[f(x_i,y_i)]$

​        右矩形(隐式)：$y_{i+1}=y_i+h_i[f(x_{i+1},y_{i+1})]$

​        梯形公式: $y_{i+1} = y_i+h_i/2[f(x_i,y_i)+f(x_{i+1},y_{i+1})]$



进行简单的运算，将未知量的项放在左边，将已知量放在右边可得

###### 欧拉法

$$y_{i+1}=y_i+h_if(x_i,y_i)$$

$$y_0=y(x_0)$$

###### 后退欧拉法

$$y_i-f(x_i,y_i)h_{i-1}=y_{i-1}$$

$$y_0=y(x_0)$$

对于欧拉法形成的方程直接计算即可(显式)，但对于后退的欧拉法形成的方程则无法直接计算，因为方程左边的$f(x_i,y_i)$是未知项，在计算的时候通常使用迭代方法求解，迭代的实质是逐步显化。

$y_i^1=y_{i-1}+f(x_i,y_i)h_{i-1}$

$y_i^2=y_{i-1}+f(x_i,y_i^1)h_{i-1}$

$y_i^3=y_{i-1}+f(x_i,y_i^2)h_{i-1}$

.

$y_i^k=y_{i-1}+f(x_i,y_i^{k-1})h_{i-1}$

当$|y_i^k-y_i^{k-1}|<\epsilon$时，最终$y_i=y_i^k$



###### 改进的欧拉公式(预估校正法):

先用欧拉法得到一个近似值，再使用梯形公式将这个近似值校正一次，即

预估：$$\overline{y}_{i+1}=y_i+h_if(x_i,y_i)$$

校正：$$y_{i+1} = y_i+h_i/2[f(x_i,y_i)+f(x_{i+1},\overline{y}_{i+1})]$$

继续化简可写为下面的形式:

$$y_p=y_i+h_if(x_i,y_i)$$

$y_c=y_i+h_if(x_{i+1},y_p)$

$y_{i+1}=\frac{1}{2}(y_p+y_c)$





##### 龙格库塔(Runge-Kutta)

​        对$y(x_{i+1})=y(x_i)+\int_{x_i}^{x_{i+1}}f(x,y)dx$ 右端的积分部分使用更高精度的积分公式

